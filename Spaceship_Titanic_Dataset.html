import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
%matplotlib inline
import seaborn as sns
sns.set()
df_train = pd.read_csv('Spaceship_Titanic_train.csv')
df_test = pd.read_csv('Spaceship_Titanic_test.csv')
df_train.head()
PassengerId	HomePlanet	CryoSleep	Cabin	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Name	Transported
0	0001_01	Europa	False	B/0/P	TRAPPIST-1e	39.0	False	0.0	0.0	0.0	0.0	0.0	Maham Ofracculy	False
1	0002_01	Earth	False	F/0/S	TRAPPIST-1e	24.0	False	109.0	9.0	25.0	549.0	44.0	Juanna Vines	True
2	0003_01	Europa	False	A/0/S	TRAPPIST-1e	58.0	True	43.0	3576.0	0.0	6715.0	49.0	Altark Susent	False
3	0003_02	Europa	False	A/0/S	TRAPPIST-1e	33.0	False	0.0	1283.0	371.0	3329.0	193.0	Solam Susent	False
4	0004_01	Earth	False	F/1/S	TRAPPIST-1e	16.0	False	303.0	70.0	151.0	565.0	2.0	Willy Santantines	True
df_test.head()
PassengerId	HomePlanet	CryoSleep	Cabin	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Name
0	0013_01	Earth	True	G/3/S	TRAPPIST-1e	27.0	False	0.0	0.0	0.0	0.0	0.0	Nelly Carsoning
1	0018_01	Earth	False	F/4/S	TRAPPIST-1e	19.0	False	0.0	9.0	0.0	2823.0	0.0	Lerome Peckers
2	0019_01	Europa	True	C/0/S	55 Cancri e	31.0	False	0.0	0.0	0.0	0.0	0.0	Sabih Unhearfus
3	0021_01	Europa	False	C/1/S	TRAPPIST-1e	38.0	False	0.0	6652.0	0.0	181.0	585.0	Meratz Caltilter
4	0023_01	Earth	False	F/5/S	TRAPPIST-1e	20.0	False	10.0	0.0	635.0	0.0	0.0	Brence Harperez
Space_Titanic = pd.concat([df_train,df_test])
Space_Titanic.head()
PassengerId	HomePlanet	CryoSleep	Cabin	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Name	Transported
0	0001_01	Europa	False	B/0/P	TRAPPIST-1e	39.0	False	0.0	0.0	0.0	0.0	0.0	Maham Ofracculy	False
1	0002_01	Earth	False	F/0/S	TRAPPIST-1e	24.0	False	109.0	9.0	25.0	549.0	44.0	Juanna Vines	True
2	0003_01	Europa	False	A/0/S	TRAPPIST-1e	58.0	True	43.0	3576.0	0.0	6715.0	49.0	Altark Susent	False
3	0003_02	Europa	False	A/0/S	TRAPPIST-1e	33.0	False	0.0	1283.0	371.0	3329.0	193.0	Solam Susent	False
4	0004_01	Earth	False	F/1/S	TRAPPIST-1e	16.0	False	303.0	70.0	151.0	565.0	2.0	Willy Santantines	True
import warnings
warnings.filterwarnings('ignore')
print(Space_Titanic.shape)
print(df_train.shape)
print(df_test.shape)
(12970, 14)
(8693, 14)
(4277, 13)
Space_Titanic.info()
<class 'pandas.core.frame.DataFrame'>
Int64Index: 12970 entries, 0 to 4276
Data columns (total 14 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   PassengerId   12970 non-null  object 
 1   HomePlanet    12682 non-null  object 
 2   CryoSleep     12660 non-null  object 
 3   Cabin         12671 non-null  object 
 4   Destination   12696 non-null  object 
 5   Age           12700 non-null  float64
 6   VIP           12674 non-null  object 
 7   RoomService   12707 non-null  float64
 8   FoodCourt     12681 non-null  float64
 9   ShoppingMall  12664 non-null  float64
 10  Spa           12686 non-null  float64
 11  VRDeck        12702 non-null  float64
 12  Name          12676 non-null  object 
 13  Transported   8693 non-null   object 
dtypes: float64(6), object(8)
memory usage: 1.5+ MB
# initially, it seems that passengerid and name are non-significant variables - to drop those variables
Space_Titanic.drop(['PassengerId', 'Name'], axis = 1, inplace = True)
Space_Titanic.head()
HomePlanet	CryoSleep	Cabin	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported
0	Europa	False	B/0/P	TRAPPIST-1e	39.0	False	0.0	0.0	0.0	0.0	0.0	False
1	Earth	False	F/0/S	TRAPPIST-1e	24.0	False	109.0	9.0	25.0	549.0	44.0	True
2	Europa	False	A/0/S	TRAPPIST-1e	58.0	True	43.0	3576.0	0.0	6715.0	49.0	False
3	Europa	False	A/0/S	TRAPPIST-1e	33.0	False	0.0	1283.0	371.0	3329.0	193.0	False
4	Earth	False	F/1/S	TRAPPIST-1e	16.0	False	303.0	70.0	151.0	565.0	2.0	True
Space_Titanic['HomePlanet'].unique()
array(['Europa', 'Earth', 'Mars', nan], dtype=object)
Space_Titanic['HomePlanet'].isnull().sum()
288
Space_Titanic['HomePlanet'].value_counts()
Earth     6865
Europa    3133
Mars      2684
Name: HomePlanet, dtype: int64
Space_Titanic['HomePlanet'] = Space_Titanic['HomePlanet'].fillna(Space_Titanic['HomePlanet'].value_counts().index[0])
Space_Titanic['HomePlanet'].isnull().sum()
0
Space_Titanic['HomePlanet'].value_counts()
Earth     7153
Europa    3133
Mars      2684
Name: HomePlanet, dtype: int64
HomePlanet = pd.get_dummies(Space_Titanic['HomePlanet'], prefix = 'HomePlanet')
HomePlanet
HomePlanet_Earth	HomePlanet_Europa	HomePlanet_Mars
0	0	1	0
1	1	0	0
2	0	1	0
3	0	1	0
4	1	0	0
...	...	...	...
4272	1	0	0
4273	1	0	0
4274	0	0	1
4275	0	1	0
4276	1	0	0
12970 rows × 3 columns

Space_Titanic.shape
(12970, 12)
Space_Titanic['CryoSleep'].value_counts()
False    8079
True     4581
Name: CryoSleep, dtype: int64
Space_Titanic['CryoSleep'].isnull().sum()
310
Space_Titanic['CryoSleep'] = Space_Titanic['CryoSleep'].fillna(Space_Titanic['CryoSleep'].value_counts().index[0])
Space_Titanic['CryoSleep'].isnull().sum()
0
Space_Titanic['CryoSleep'].value_counts()
False    8389
True     4581
Name: CryoSleep, dtype: int64
sns.countplot(x = 'CryoSleep', data = Space_Titanic)
<Axes: xlabel='CryoSleep', ylabel='count'>

Space_Titanic['Cabin'].value_counts()
G/734/S     8
G/160/P     8
D/176/S     7
G/1476/S    7
B/201/P     7
           ..
E/317/P     1
F/1039/P    1
F/1038/P    1
C/158/P     1
G/1498/S    1
Name: Cabin, Length: 9825, dtype: int64
Space_Titanic[['Cabin_deck', 'Cabin_num', 'Cabin_side']] = Space_Titanic['Cabin'].str.split('/', expand = True)
Space_Titanic.Cabin_deck.value_counts()
F    4239
G    3781
E    1323
B    1141
C    1102
D     720
A     354
T      11
Name: Cabin_deck, dtype: int64
Cabin_deck = pd.get_dummies(Space_Titanic['Cabin_deck'], prefix = 'Cabin_deck')
Cabin_deck
Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	Cabin_deck_T
0	0	1	0	0	0	0	0	0
1	0	0	0	0	0	1	0	0
2	1	0	0	0	0	0	0	0
3	1	0	0	0	0	0	0	0
4	0	0	0	0	0	1	0	0
...	...	...	...	...	...	...	...	...
4272	0	0	0	0	0	0	1	0
4273	0	0	0	0	0	0	0	0
4274	0	0	0	1	0	0	0	0
4275	0	0	0	1	0	0	0	0
4276	0	0	0	0	0	0	1	0
12970 rows × 8 columns

Cabin_side = pd.get_dummies(Space_Titanic['Cabin_side'], prefix = 'Cabin_side')
Cabin_side
Cabin_side_P	Cabin_side_S
0	1	0
1	0	1
2	0	1
3	0	1
4	0	1
...	...	...
4272	0	1
4273	0	0
4274	1	0
4275	1	0
4276	0	1
12970 rows × 2 columns

Space_Titanic.head()
HomePlanet	CryoSleep	Cabin	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_deck	Cabin_num	Cabin_side
0	Europa	False	B/0/P	TRAPPIST-1e	39.0	False	0.0	0.0	0.0	0.0	0.0	False	B	0	P
1	Earth	False	F/0/S	TRAPPIST-1e	24.0	False	109.0	9.0	25.0	549.0	44.0	True	F	0	S
2	Europa	False	A/0/S	TRAPPIST-1e	58.0	True	43.0	3576.0	0.0	6715.0	49.0	False	A	0	S
3	Europa	False	A/0/S	TRAPPIST-1e	33.0	False	0.0	1283.0	371.0	3329.0	193.0	False	A	0	S
4	Earth	False	F/1/S	TRAPPIST-1e	16.0	False	303.0	70.0	151.0	565.0	2.0	True	F	1	S
Space_Titanic.drop('Cabin', axis = 1, inplace = True)
Space_Titanic.head()
HomePlanet	CryoSleep	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_deck	Cabin_num	Cabin_side
0	Europa	False	TRAPPIST-1e	39.0	False	0.0	0.0	0.0	0.0	0.0	False	B	0	P
1	Earth	False	TRAPPIST-1e	24.0	False	109.0	9.0	25.0	549.0	44.0	True	F	0	S
2	Europa	False	TRAPPIST-1e	58.0	True	43.0	3576.0	0.0	6715.0	49.0	False	A	0	S
3	Europa	False	TRAPPIST-1e	33.0	False	0.0	1283.0	371.0	3329.0	193.0	False	A	0	S
4	Earth	False	TRAPPIST-1e	16.0	False	303.0	70.0	151.0	565.0	2.0	True	F	1	S
Space_Titanic.shape
(12970, 14)
Space_Titanic.Cabin_num.value_counts()
82      34
4       28
56      28
95      27
31      27
        ..
1848     1
1847     1
1846     1
1844     1
1890     1
Name: Cabin_num, Length: 1894, dtype: int64
Space_Titanic['Cabin_num'].isnull().sum()
299
Space_Titanic['Cabin_num'] = Space_Titanic['Cabin_num'].fillna(Space_Titanic['Cabin_num'].median())
Space_Titanic['Cabin_num'].isnull().sum()
0
Space_Titanic.head()
HomePlanet	CryoSleep	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_deck	Cabin_num	Cabin_side
0	Europa	False	TRAPPIST-1e	39.0	False	0.0	0.0	0.0	0.0	0.0	False	B	0	P
1	Earth	False	TRAPPIST-1e	24.0	False	109.0	9.0	25.0	549.0	44.0	True	F	0	S
2	Europa	False	TRAPPIST-1e	58.0	True	43.0	3576.0	0.0	6715.0	49.0	False	A	0	S
3	Europa	False	TRAPPIST-1e	33.0	False	0.0	1283.0	371.0	3329.0	193.0	False	A	0	S
4	Earth	False	TRAPPIST-1e	16.0	False	303.0	70.0	151.0	565.0	2.0	True	F	1	S
Space_Titanic['Destination'].value_counts()
TRAPPIST-1e      8871
55 Cancri e      2641
PSO J318.5-22    1184
Name: Destination, dtype: int64
Space_Titanic['Destination'] = Space_Titanic['Destination'].fillna(Space_Titanic['Destination'].value_counts().index[0])
Space_Titanic['Destination'].value_counts()
TRAPPIST-1e      9145
55 Cancri e      2641
PSO J318.5-22    1184
Name: Destination, dtype: int64
Destination = pd.get_dummies(Space_Titanic['Destination'], prefix = 'Destination')
Space_Titanic.head()
HomePlanet	CryoSleep	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_deck	Cabin_num	Cabin_side
0	Europa	False	TRAPPIST-1e	39.0	False	0.0	0.0	0.0	0.0	0.0	False	B	0	P
1	Earth	False	TRAPPIST-1e	24.0	False	109.0	9.0	25.0	549.0	44.0	True	F	0	S
2	Europa	False	TRAPPIST-1e	58.0	True	43.0	3576.0	0.0	6715.0	49.0	False	A	0	S
3	Europa	False	TRAPPIST-1e	33.0	False	0.0	1283.0	371.0	3329.0	193.0	False	A	0	S
4	Earth	False	TRAPPIST-1e	16.0	False	303.0	70.0	151.0	565.0	2.0	True	F	1	S
Destination
Destination_55 Cancri e	Destination_PSO J318.5-22	Destination_TRAPPIST-1e
0	0	0	1
1	0	0	1
2	0	0	1
3	0	0	1
4	0	0	1
...	...	...	...
4272	0	0	1
4273	0	0	1
4274	1	0	0
4275	0	0	1
4276	0	1	0
12970 rows × 3 columns

sns.countplot(x = 'Age' , data = Space_Titanic)
<Axes: xlabel='Age', ylabel='count'>

Space_Titanic['Age'].isnull().sum()
270
Space_Titanic['Age'] = Space_Titanic['Age'].fillna(Space_Titanic['Age'].mean())
Space_Titanic['Age'].isnull().sum()
0
sns.countplot(x = 'Age' , data = Space_Titanic)
<Axes: xlabel='Age', ylabel='count'>

Space_Titanic['VIP'].value_counts()
False    12401
True       273
Name: VIP, dtype: int64
Space_Titanic['VIP'].isnull().sum()
296
Space_Titanic['VIP'] = Space_Titanic['VIP'].fillna(Space_Titanic['VIP'].value_counts().index[0])
Space_Titanic['VIP'].value_counts()
False    12697
True       273
Name: VIP, dtype: int64
sns.countplot(x = 'VIP' , data = Space_Titanic)
<Axes: xlabel='VIP', ylabel='count'>

Space_Titanic.info()
<class 'pandas.core.frame.DataFrame'>
Int64Index: 12970 entries, 0 to 4276
Data columns (total 14 columns):
 #   Column        Non-Null Count  Dtype  
---  ------        --------------  -----  
 0   HomePlanet    12970 non-null  object 
 1   CryoSleep     12970 non-null  bool   
 2   Destination   12970 non-null  object 
 3   Age           12970 non-null  float64
 4   VIP           12970 non-null  bool   
 5   RoomService   12707 non-null  float64
 6   FoodCourt     12681 non-null  float64
 7   ShoppingMall  12664 non-null  float64
 8   Spa           12686 non-null  float64
 9   VRDeck        12702 non-null  float64
 10  Transported   8693 non-null   object 
 11  Cabin_deck    12671 non-null  object 
 12  Cabin_num     12970 non-null  object 
 13  Cabin_side    12671 non-null  object 
dtypes: bool(2), float64(6), object(6)
memory usage: 1.3+ MB
Space_Titanic['RoomService'].value_counts()
0.0       8303
1.0        185
2.0        113
3.0         89
4.0         71
          ... 
263.0        1
271.0        1
922.0        1
3905.0       1
652.0        1
Name: RoomService, Length: 1578, dtype: int64
Space_Titanic['RoomService'].isnull().sum()
263
Space_Titanic['RoomService'] = Space_Titanic['RoomService'].fillna(Space_Titanic['RoomService'].median())
Space_Titanic['RoomService'].isnull().sum()
0
Space_Titanic['FoodCourt'].isnull().sum()
289
Space_Titanic['FoodCourt'].value_counts()
0.0        8146
1.0         175
2.0         105
4.0          75
3.0          74
           ... 
2853.0        1
9495.0        1
342.0         1
11552.0       1
601.0         1
Name: FoodCourt, Length: 1953, dtype: int64
Space_Titanic['FoodCourt'] = Space_Titanic['FoodCourt'].fillna(Space_Titanic['FoodCourt'].median())
Space_Titanic['FoodCourt'].isnull().sum()
0
Space_Titanic.head()
HomePlanet	CryoSleep	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_deck	Cabin_num	Cabin_side
0	Europa	False	TRAPPIST-1e	39.0	False	0.0	0.0	0.0	0.0	0.0	False	B	0	P
1	Earth	False	TRAPPIST-1e	24.0	False	109.0	9.0	25.0	549.0	44.0	True	F	0	S
2	Europa	False	TRAPPIST-1e	58.0	True	43.0	3576.0	0.0	6715.0	49.0	False	A	0	S
3	Europa	False	TRAPPIST-1e	33.0	False	0.0	1283.0	371.0	3329.0	193.0	False	A	0	S
4	Earth	False	TRAPPIST-1e	16.0	False	303.0	70.0	151.0	565.0	2.0	True	F	1	S
Space_Titanic['ShoppingMall'].value_counts()
0.0       8331
1.0        225
2.0        112
3.0         94
4.0         69
          ... 
751.0        1
1573.0       1
1541.0       1
1661.0       1
3851.0       1
Name: ShoppingMall, Length: 1367, dtype: int64
Space_Titanic['ShoppingMall'].isnull().sum()
306
Space_Titanic['ShoppingMall'] = Space_Titanic['ShoppingMall'].fillna(Space_Titanic['ShoppingMall'].mean())
Space_Titanic['ShoppingMall'].isnull().sum()
0
Space_Titanic['Spa'].value_counts()
0.0       7935
1.0        218
2.0        148
3.0         82
4.0         73
          ... 
971.0        1
2290.0       1
1450.0       1
4517.0       1
1812.0       1
Name: Spa, Length: 1679, dtype: int64
Space_Titanic['Spa'].isnull().sum()
284
Space_Titanic['Spa'] = Space_Titanic['Spa'].fillna(Space_Titanic['Spa'].mean())
Space_Titanic['Spa'].isnull().sum()
0
Space_Titanic['VRDeck'].value_counts()
0.0       8252
1.0        211
2.0        108
3.0         89
5.0         68
          ... 
395.0        1
3186.0       1
2519.0       1
1652.0       1
494.0        1
Name: VRDeck, Length: 1642, dtype: int64
Space_Titanic['VRDeck'] = Space_Titanic['VRDeck'].fillna(Space_Titanic['VRDeck'].median())
Space_Titanic['VRDeck'].isnull().sum()
0
Space_Titanic['Transported'].value_counts()
True     4378
False    4315
Name: Transported, dtype: int64
Space_Titanic['Transported'].isnull().sum()/len(Space_Titanic)*100
32.97609868928296
len(Space_Titanic)
12970
#addtional data needed to merge into Space_Titanic - Destination, Cabin_side, Cabin_deck, HomePlanet, 
df = pd.concat([Space_Titanic, Destination, Cabin_side, Cabin_deck, HomePlanet], axis = "columns")
df.head()
HomePlanet	CryoSleep	Destination	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	...	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	Cabin_deck_T	HomePlanet_Earth	HomePlanet_Europa	HomePlanet_Mars
0	Europa	False	TRAPPIST-1e	39.0	False	0.0	0.0	0.0	0.0	0.0	...	1	0	0	0	0	0	0	0	1	0
1	Earth	False	TRAPPIST-1e	24.0	False	109.0	9.0	25.0	549.0	44.0	...	0	0	0	0	1	0	0	1	0	0
2	Europa	False	TRAPPIST-1e	58.0	True	43.0	3576.0	0.0	6715.0	49.0	...	0	0	0	0	0	0	0	0	1	0
3	Europa	False	TRAPPIST-1e	33.0	False	0.0	1283.0	371.0	3329.0	193.0	...	0	0	0	0	0	0	0	0	1	0
4	Earth	False	TRAPPIST-1e	16.0	False	303.0	70.0	151.0	565.0	2.0	...	0	0	0	0	1	0	0	1	0	0
5 rows × 30 columns

df.info()
<class 'pandas.core.frame.DataFrame'>
Int64Index: 12970 entries, 0 to 4276
Data columns (total 30 columns):
 #   Column                     Non-Null Count  Dtype  
---  ------                     --------------  -----  
 0   HomePlanet                 12970 non-null  object 
 1   CryoSleep                  12970 non-null  bool   
 2   Destination                12970 non-null  object 
 3   Age                        12970 non-null  float64
 4   VIP                        12970 non-null  bool   
 5   RoomService                12970 non-null  float64
 6   FoodCourt                  12970 non-null  float64
 7   ShoppingMall               12970 non-null  float64
 8   Spa                        12970 non-null  float64
 9   VRDeck                     12970 non-null  float64
 10  Transported                8693 non-null   object 
 11  Cabin_deck                 12671 non-null  object 
 12  Cabin_num                  12970 non-null  object 
 13  Cabin_side                 12671 non-null  object 
 14  Destination_55 Cancri e    12970 non-null  uint8  
 15  Destination_PSO J318.5-22  12970 non-null  uint8  
 16  Destination_TRAPPIST-1e    12970 non-null  uint8  
 17  Cabin_side_P               12970 non-null  uint8  
 18  Cabin_side_S               12970 non-null  uint8  
 19  Cabin_deck_A               12970 non-null  uint8  
 20  Cabin_deck_B               12970 non-null  uint8  
 21  Cabin_deck_C               12970 non-null  uint8  
 22  Cabin_deck_D               12970 non-null  uint8  
 23  Cabin_deck_E               12970 non-null  uint8  
 24  Cabin_deck_F               12970 non-null  uint8  
 25  Cabin_deck_G               12970 non-null  uint8  
 26  Cabin_deck_T               12970 non-null  uint8  
 27  HomePlanet_Earth           12970 non-null  uint8  
 28  HomePlanet_Europa          12970 non-null  uint8  
 29  HomePlanet_Mars            12970 non-null  uint8  
dtypes: bool(2), float64(6), object(6), uint8(16)
memory usage: 1.5+ MB
#to drop columns - HomePlanet, HomePlanet_Earth, Cabin_deck, Cabin_deck_T, Cabin_side, Cabin_side_S,Destination, Destination_TRAPPIST-1e,  
df.drop(['HomePlanet', 'HomePlanet_Earth', 'Cabin_deck', 'Cabin_deck_T', 'Cabin_side', 'Cabin_side_S', 'Destination', 'Destination_TRAPPIST-1e'], axis = 1, inplace = True)
df.info()
<class 'pandas.core.frame.DataFrame'>
Int64Index: 12970 entries, 0 to 4276
Data columns (total 22 columns):
 #   Column                     Non-Null Count  Dtype  
---  ------                     --------------  -----  
 0   CryoSleep                  12970 non-null  bool   
 1   Age                        12970 non-null  float64
 2   VIP                        12970 non-null  bool   
 3   RoomService                12970 non-null  float64
 4   FoodCourt                  12970 non-null  float64
 5   ShoppingMall               12970 non-null  float64
 6   Spa                        12970 non-null  float64
 7   VRDeck                     12970 non-null  float64
 8   Transported                8693 non-null   object 
 9   Cabin_num                  12970 non-null  object 
 10  Destination_55 Cancri e    12970 non-null  uint8  
 11  Destination_PSO J318.5-22  12970 non-null  uint8  
 12  Cabin_side_P               12970 non-null  uint8  
 13  Cabin_deck_A               12970 non-null  uint8  
 14  Cabin_deck_B               12970 non-null  uint8  
 15  Cabin_deck_C               12970 non-null  uint8  
 16  Cabin_deck_D               12970 non-null  uint8  
 17  Cabin_deck_E               12970 non-null  uint8  
 18  Cabin_deck_F               12970 non-null  uint8  
 19  Cabin_deck_G               12970 non-null  uint8  
 20  HomePlanet_Europa          12970 non-null  uint8  
 21  HomePlanet_Mars            12970 non-null  uint8  
dtypes: bool(2), float64(6), object(2), uint8(12)
memory usage: 1.1+ MB
df.head()
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_num	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	False	39.0	False	0.0	0.0	0.0	0.0	0.0	False	0	...	1	0	1	0	0	0	0	0	1	0
1	False	24.0	False	109.0	9.0	25.0	549.0	44.0	True	0	...	0	0	0	0	0	0	1	0	0	0
2	False	58.0	True	43.0	3576.0	0.0	6715.0	49.0	False	0	...	0	1	0	0	0	0	0	0	1	0
3	False	33.0	False	0.0	1283.0	371.0	3329.0	193.0	False	0	...	0	1	0	0	0	0	0	0	1	0
4	False	16.0	False	303.0	70.0	151.0	565.0	2.0	True	1	...	0	0	0	0	0	0	1	0	0	0
5 rows × 22 columns

df.CryoSleep.value_counts()
False    8389
True     4581
Name: CryoSleep, dtype: int64
df.CryoSleep = df.CryoSleep.astype('category')
df.CryoSleep = df.CryoSleep.cat.codes
df.CryoSleep.value_counts()
0    8389
1    4581
Name: CryoSleep, dtype: int64
df.VIP.value_counts()
False    12697
True       273
Name: VIP, dtype: int64
df.VIP = df.VIP.astype('category')
df.VIP = df.VIP.cat.codes
df.VIP.value_counts()
0    12697
1      273
Name: VIP, dtype: int64
df.Transported.value_counts()
True     4378
False    4315
Name: Transported, dtype: int64
df.Transported = Space_Titanic.Transported 
df.Transported.value_counts()
True     4378
False    4315
Name: Transported, dtype: int64
df.Transported = df.Transported.replace('True', '1')
df.Transported = df.Transported.replace('False', '0')
df.Transported = df.Transported.astype('category')
df.Transported = df.Transported.cat.codes
df.Transported.value_counts()
 1    4378
 0    4315
-1    4277
Name: Transported, dtype: int64
df.Transported = df.Transported.replace(-1, np.nan)
df.Transported.value_counts()
1.0    4378
0.0    4315
Name: Transported, dtype: int64
df.Transported.isnull().sum()
4277
df.head()
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_num	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	0	39.0	0	0.0	0.0	0.0	0.0	0.0	0.0	0	...	1	0	1	0	0	0	0	0	1	0
1	0	24.0	0	109.0	9.0	25.0	549.0	44.0	1.0	0	...	0	0	0	0	0	0	1	0	0	0
2	0	58.0	1	43.0	3576.0	0.0	6715.0	49.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
3	0	33.0	0	0.0	1283.0	371.0	3329.0	193.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
4	0	16.0	0	303.0	70.0	151.0	565.0	2.0	1.0	1	...	0	0	0	0	0	0	1	0	0	0
5 rows × 22 columns

df.info()
<class 'pandas.core.frame.DataFrame'>
Int64Index: 12970 entries, 0 to 4276
Data columns (total 22 columns):
 #   Column                     Non-Null Count  Dtype  
---  ------                     --------------  -----  
 0   CryoSleep                  12970 non-null  int8   
 1   Age                        12970 non-null  float64
 2   VIP                        12970 non-null  int8   
 3   RoomService                12970 non-null  float64
 4   FoodCourt                  12970 non-null  float64
 5   ShoppingMall               12970 non-null  float64
 6   Spa                        12970 non-null  float64
 7   VRDeck                     12970 non-null  float64
 8   Transported                8693 non-null   float64
 9   Cabin_num                  12970 non-null  object 
 10  Destination_55 Cancri e    12970 non-null  uint8  
 11  Destination_PSO J318.5-22  12970 non-null  uint8  
 12  Cabin_side_P               12970 non-null  uint8  
 13  Cabin_deck_A               12970 non-null  uint8  
 14  Cabin_deck_B               12970 non-null  uint8  
 15  Cabin_deck_C               12970 non-null  uint8  
 16  Cabin_deck_D               12970 non-null  uint8  
 17  Cabin_deck_E               12970 non-null  uint8  
 18  Cabin_deck_F               12970 non-null  uint8  
 19  Cabin_deck_G               12970 non-null  uint8  
 20  HomePlanet_Europa          12970 non-null  uint8  
 21  HomePlanet_Mars            12970 non-null  uint8  
dtypes: float64(7), int8(2), object(1), uint8(12)
memory usage: 1.1+ MB
df.Cabin_num.value_counts()
431.0    299
82        34
56        28
4         28
31        27
        ... 
1848       1
1847       1
1846       1
1844       1
1890       1
Name: Cabin_num, Length: 1895, dtype: int64
#handling missing values - done
#encoding - done
# handling outliers - not required in logistic regression, 
#feature scaling, 
#data balancing
sns.boxplot(x = 'CryoSleep', data = df)
<Axes: xlabel='CryoSleep'>

sns.boxplot(x = 'Age', data = df)
<Axes: xlabel='Age'>

#len(df[df.Age > 62])
237
'''
q1 = df.Age.quantile(0.25)
q3 = df.Age.quantile(0.75)
iqr = q3-q1

upper = q3 + 1.5* iqr
lower = q1 - 1.5* iqr

df.Age = np.where(df.Age > upper, upper,
                 np.where(df.Age < lower, lower,
                         df.Age))

sns.boxplot(x = 'Age', data = df)
'''
"\nq1 = df.Age.quantile(0.25)\nq3 = df.Age.quantile(0.75)\niqr = q3-q1\n\nupper = q3 + 1.5* iqr\nlower = q1 - 1.5* iqr\n\ndf.Age = np.where(df.Age > upper, upper,\n                 np.where(df.Age < lower, lower,\n                         df.Age))\n\nsns.boxplot(x = 'Age', data = df)\n"
sns.distplot(df.RoomService)
<Axes: xlabel='RoomService', ylabel='Density'>

sns.boxplot(x = 'RoomService', data = df)
<Axes: xlabel='RoomService'>

'''
q1 = df.RoomService.quantile(0.25)
q3 = df.RoomService.quantile(0.75)
iqr = q3-q1

upper = q3 + 1.5* iqr
lower = q1 - 1.5* iqr

df.RoomService = np.where(df.RoomService > upper, upper,
                 np.where(df.RoomService < lower, lower,
                         df.RoomService))

sns.boxplot(x = 'RoomService', data = df)
'''
"\nq1 = df.RoomService.quantile(0.25)\nq3 = df.RoomService.quantile(0.75)\niqr = q3-q1\n\nupper = q3 + 1.5* iqr\nlower = q1 - 1.5* iqr\n\ndf.RoomService = np.where(df.RoomService > upper, upper,\n                 np.where(df.RoomService < lower, lower,\n                         df.RoomService))\n\nsns.boxplot(x = 'RoomService', data = df)\n"
sns.boxplot(x = 'FoodCourt', data = df)
<Axes: xlabel='FoodCourt'>

sns.distplot(df.FoodCourt)
<Axes: xlabel='FoodCourt', ylabel='Density'>

'''
q1 = df.FoodCourt.quantile(0.25)
q3 = df.FoodCourt.quantile(0.75)
iqr = q3-q1

upper = q3 + 1.5* iqr
lower = q1 - 1.5* iqr

df.FoodCourt = np.where(df.FoodCourt > upper, upper,
                 np.where(df.FoodCourt < lower, lower,
                         df.FoodCourt))

sns.boxplot(x = 'FoodCourt', data = df)
'''
"\nq1 = df.FoodCourt.quantile(0.25)\nq3 = df.FoodCourt.quantile(0.75)\niqr = q3-q1\n\nupper = q3 + 1.5* iqr\nlower = q1 - 1.5* iqr\n\ndf.FoodCourt = np.where(df.FoodCourt > upper, upper,\n                 np.where(df.FoodCourt < lower, lower,\n                         df.FoodCourt))\n\nsns.boxplot(x = 'FoodCourt', data = df)\n"
sns.distplot(df.FoodCourt)
<Axes: xlabel='FoodCourt', ylabel='Density'>

sns.boxplot(x = 'ShoppingMall', data = df)
<Axes: xlabel='ShoppingMall'>

sns.distplot(df.ShoppingMall)
<Axes: xlabel='ShoppingMall', ylabel='Density'>

'''
q1 = df.ShoppingMall.quantile(0.25)
q3 = df.ShoppingMall.quantile(0.75)
iqr = q3-q1

upper = q3 + 1.5* iqr
lower = q1 - 1.5* iqr

df.ShoppingMall = np.where(df.ShoppingMall > upper, upper,
                 np.where(df.ShoppingMall < lower, lower,
                         df.ShoppingMall))

sns.boxplot(x = 'ShoppingMall', data = df)
'''
"\nq1 = df.ShoppingMall.quantile(0.25)\nq3 = df.ShoppingMall.quantile(0.75)\niqr = q3-q1\n\nupper = q3 + 1.5* iqr\nlower = q1 - 1.5* iqr\n\ndf.ShoppingMall = np.where(df.ShoppingMall > upper, upper,\n                 np.where(df.ShoppingMall < lower, lower,\n                         df.ShoppingMall))\n\nsns.boxplot(x = 'ShoppingMall', data = df)\n"
sns.distplot(df.ShoppingMall)
<Axes: xlabel='ShoppingMall', ylabel='Density'>

sns.boxplot(x = 'Spa', data = df)
<Axes: xlabel='Spa'>

'''
q1 = df.Spa.quantile(0.25)
q3 = df.Spa.quantile(0.75)
iqr = q3-q1

upper = q3 + 1.5* iqr
lower = q1 - 1.5* iqr

df.Spa = np.where(df.Spa > upper, upper,
                 np.where(df.Spa < lower, lower,
                         df.Spa))

sns.boxplot(x = 'Spa', data = df)
'''
"\nq1 = df.Spa.quantile(0.25)\nq3 = df.Spa.quantile(0.75)\niqr = q3-q1\n\nupper = q3 + 1.5* iqr\nlower = q1 - 1.5* iqr\n\ndf.Spa = np.where(df.Spa > upper, upper,\n                 np.where(df.Spa < lower, lower,\n                         df.Spa))\n\nsns.boxplot(x = 'Spa', data = df)\n"
sns.boxplot(x = 'VRDeck', data = df)
<Axes: xlabel='VRDeck'>

'''
q1 = df.VRDeck.quantile(0.25)
q3 = df.VRDeck.quantile(0.75)
iqr = q3-q1

upper = q3 + 1.5* iqr
lower = q1 - 1.5* iqr

df.VRDeck = np.where(df.VRDeck > upper, upper,
                 np.where(df.VRDeck < lower, lower,
                         df.VRDeck))

sns.boxplot(x = 'VRDeck', data = df)
'''
"\nq1 = df.VRDeck.quantile(0.25)\nq3 = df.VRDeck.quantile(0.75)\niqr = q3-q1\n\nupper = q3 + 1.5* iqr\nlower = q1 - 1.5* iqr\n\ndf.VRDeck = np.where(df.VRDeck > upper, upper,\n                 np.where(df.VRDeck < lower, lower,\n                         df.VRDeck))\n\nsns.boxplot(x = 'VRDeck', data = df)\n"
df.Cabin_num.dtype
dtype('O')
df.Cabin_num = df.Cabin_num.astype('int')
sns.boxplot(x = 'Cabin_num', data = df)
<Axes: xlabel='Cabin_num'>

df.columns
Index(['CryoSleep', 'Age', 'VIP', 'RoomService', 'FoodCourt', 'ShoppingMall',
       'Spa', 'VRDeck', 'Transported', 'Cabin_num', 'Destination_55 Cancri e',
       'Destination_PSO J318.5-22', 'Cabin_side_P', 'Cabin_deck_A',
       'Cabin_deck_B', 'Cabin_deck_C', 'Cabin_deck_D', 'Cabin_deck_E',
       'Cabin_deck_F', 'Cabin_deck_G', 'HomePlanet_Europa', 'HomePlanet_Mars'],
      dtype='object')
sns.boxplot(x = 'Destination_55 Cancri e', data = df)
<Axes: xlabel='Destination_55 Cancri e'>

df.head()
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_num	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	0	39.0	0	0.0	0.0	0.0	0.0	0.0	0.0	0	...	1	0	1	0	0	0	0	0	1	0
1	0	24.0	0	109.0	9.0	25.0	549.0	44.0	1.0	0	...	0	0	0	0	0	0	1	0	0	0
2	0	58.0	1	43.0	3576.0	0.0	6715.0	49.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
3	0	33.0	0	0.0	1283.0	371.0	3329.0	193.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
4	0	16.0	0	303.0	70.0	151.0	565.0	2.0	1.0	1	...	0	0	0	0	0	0	1	0	0	0
5 rows × 22 columns

# feature scaling - not required for classification problem
# data imbalance - not required, transported coloum has 50%-50% 0 and 1's  
plt.figure(figsize = (16,16))
sns.heatmap(df.corr(), annot = True, cmap = 'coolwarm')
plt.show()

#!pip install dtale
import dtale
import dtale.app as dtale_app
dtale.show(df)

df.Transported.value_counts()
1.0    4378
0.0    4315
Name: Transported, dtype: int64
df['Transported'].isnull().sum()
4277
df[df['Transported'] == np.nan]
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_num	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0 rows × 22 columns

# to split the data into train and test
df_test = df[df.Transported.isnull() == True]
df_test
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_num	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	1	27.000000	0	0.0	0.0	0.0	0.0	0.0	NaN	3	...	0	0	0	0	0	0	0	1	0	0
1	0	19.000000	0	0.0	9.0	0.0	2823.0	0.0	NaN	4	...	0	0	0	0	0	0	1	0	0	0
2	1	31.000000	0	0.0	0.0	0.0	0.0	0.0	NaN	0	...	0	0	0	1	0	0	0	0	1	0
3	0	38.000000	0	0.0	6652.0	0.0	181.0	585.0	NaN	1	...	0	0	0	1	0	0	0	0	1	0
4	0	20.000000	0	10.0	0.0	635.0	0.0	0.0	NaN	5	...	0	0	0	0	0	0	1	0	0	0
...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...
4272	1	34.000000	0	0.0	0.0	0.0	0.0	0.0	NaN	1496	...	0	0	0	0	0	0	0	1	0	0
4273	0	42.000000	0	0.0	847.0	17.0	10.0	144.0	NaN	431	...	0	0	0	0	0	0	0	0	0	0
4274	1	28.771969	0	0.0	0.0	0.0	0.0	0.0	NaN	296	...	1	0	0	0	1	0	0	0	0	1
4275	0	28.771969	0	0.0	2680.0	0.0	0.0	523.0	NaN	297	...	1	0	0	0	1	0	0	0	1	0
4276	1	43.000000	0	0.0	0.0	0.0	0.0	0.0	NaN	1498	...	0	0	0	0	0	0	0	1	0	0
4277 rows × 22 columns

df_train = df[df.Transported.isnull() != True]
df_train
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_num	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	0	39.0	0	0.0	0.0	0.0	0.0	0.0	0.0	0	...	1	0	1	0	0	0	0	0	1	0
1	0	24.0	0	109.0	9.0	25.0	549.0	44.0	1.0	0	...	0	0	0	0	0	0	1	0	0	0
2	0	58.0	1	43.0	3576.0	0.0	6715.0	49.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
3	0	33.0	0	0.0	1283.0	371.0	3329.0	193.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
4	0	16.0	0	303.0	70.0	151.0	565.0	2.0	1.0	1	...	0	0	0	0	0	0	1	0	0	0
...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...
8688	0	41.0	1	0.0	6819.0	0.0	1643.0	74.0	0.0	98	...	1	1	0	0	0	0	0	0	1	0
8689	1	18.0	0	0.0	0.0	0.0	0.0	0.0	0.0	1499	...	0	0	0	0	0	0	0	1	0	0
8690	0	26.0	0	0.0	0.0	1872.0	1.0	0.0	1.0	1500	...	0	0	0	0	0	0	0	1	0	0
8691	0	32.0	0	0.0	1049.0	0.0	353.0	3235.0	0.0	608	...	0	0	0	0	0	1	0	0	1	0
8692	0	44.0	0	126.0	4688.0	0.0	0.0	12.0	1.0	608	...	0	0	0	0	0	1	0	0	1	0
8693 rows × 22 columns

df_test.drop('Transported', axis =1, inplace = True)
df_test.head()
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Cabin_num	Destination_55 Cancri e	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	1	27.0	0	0.0	0.0	0.0	0.0	0.0	3	0	...	0	0	0	0	0	0	0	1	0	0
1	0	19.0	0	0.0	9.0	0.0	2823.0	0.0	4	0	...	0	0	0	0	0	0	1	0	0	0
2	1	31.0	0	0.0	0.0	0.0	0.0	0.0	0	1	...	0	0	0	1	0	0	0	0	1	0
3	0	38.0	0	0.0	6652.0	0.0	181.0	585.0	1	0	...	0	0	0	1	0	0	0	0	1	0
4	0	20.0	0	10.0	0.0	635.0	0.0	0.0	5	0	...	0	0	0	0	0	0	1	0	0	0
5 rows × 21 columns

df_train.head()
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_num	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	0	39.0	0	0.0	0.0	0.0	0.0	0.0	0.0	0	...	1	0	1	0	0	0	0	0	1	0
1	0	24.0	0	109.0	9.0	25.0	549.0	44.0	1.0	0	...	0	0	0	0	0	0	1	0	0	0
2	0	58.0	1	43.0	3576.0	0.0	6715.0	49.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
3	0	33.0	0	0.0	1283.0	371.0	3329.0	193.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
4	0	16.0	0	303.0	70.0	151.0	565.0	2.0	1.0	1	...	0	0	0	0	0	0	1	0	0	0
5 rows × 22 columns

# to split dep. and indep. data from train data
x = df_train.drop('Transported',axis = 1)
x
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Cabin_num	Destination_55 Cancri e	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	0	39.0	0	0.0	0.0	0.0	0.0	0.0	0	0	...	1	0	1	0	0	0	0	0	1	0
1	0	24.0	0	109.0	9.0	25.0	549.0	44.0	0	0	...	0	0	0	0	0	0	1	0	0	0
2	0	58.0	1	43.0	3576.0	0.0	6715.0	49.0	0	0	...	0	1	0	0	0	0	0	0	1	0
3	0	33.0	0	0.0	1283.0	371.0	3329.0	193.0	0	0	...	0	1	0	0	0	0	0	0	1	0
4	0	16.0	0	303.0	70.0	151.0	565.0	2.0	1	0	...	0	0	0	0	0	0	1	0	0	0
...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...
8688	0	41.0	1	0.0	6819.0	0.0	1643.0	74.0	98	1	...	1	1	0	0	0	0	0	0	1	0
8689	1	18.0	0	0.0	0.0	0.0	0.0	0.0	1499	0	...	0	0	0	0	0	0	0	1	0	0
8690	0	26.0	0	0.0	0.0	1872.0	1.0	0.0	1500	0	...	0	0	0	0	0	0	0	1	0	0
8691	0	32.0	0	0.0	1049.0	0.0	353.0	3235.0	608	1	...	0	0	0	0	0	1	0	0	1	0
8692	0	44.0	0	126.0	4688.0	0.0	0.0	12.0	608	0	...	0	0	0	0	0	1	0	0	1	0
8693 rows × 21 columns

y = df_train.Transported
y
0       0.0
1       1.0
2       0.0
3       0.0
4       1.0
       ... 
8688    0.0
8689    0.0
8690    1.0
8691    0.0
8692    1.0
Name: Transported, Length: 8693, dtype: float64
from sklearn.model_selection import train_test_split
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25,random_state=1,
                                                    stratify=y)
from sklearn.linear_model import LogisticRegression
Log_Regre = LogisticRegression()
Log_Regre.fit(x_train,y_train)

LogisticRegression
LogisticRegression()
y_pred_train = Log_Regre.predict(x_train)
y_pred_test = Log_Regre.predict(x_test)
y_pred_test
array([1., 0., 1., ..., 1., 0., 0.])
# model evaluation
from sklearn.metrics import classification_report, accuracy_score, confusion_matrix
print('Classification Report', classification_report(y_train, y_pred_train))
print('*****'*8)
print('Classification Report', classification_report(y_test, y_pred_test))
Classification Report               precision    recall  f1-score   support

         0.0       0.80      0.77      0.78      3236
         1.0       0.78      0.81      0.79      3283

    accuracy                           0.79      6519
   macro avg       0.79      0.79      0.79      6519
weighted avg       0.79      0.79      0.79      6519

****************************************
Classification Report               precision    recall  f1-score   support

         0.0       0.81      0.77      0.79      1079
         1.0       0.78      0.82      0.80      1095

    accuracy                           0.79      2174
   macro avg       0.79      0.79      0.79      2174
weighted avg       0.79      0.79      0.79      2174

print('accuracy_score', accuracy_score(y_train, y_pred_train))
print('*****'*8)
print('accuracy_score', accuracy_score(y_test, y_pred_test))
accuracy_score 0.7875441018561129
****************************************
accuracy_score 0.7930082796688133
print('confusion_matrix', confusion_matrix(y_train, y_pred_train))
print('*****'*8)
print('confusion_matrix', confusion_matrix(y_test, y_pred_test))
confusion_matrix [[2481  755]
 [ 630 2653]]
****************************************
confusion_matrix [[830 249]
 [201 894]]
# cross validation
from sklearn.model_selection import cross_val_score
training_accuracy = cross_val_score(Log_Regre, x_train, y_train, cv = 10)
testing_accuracy = cross_val_score(Log_Regre, x_test, y_test, cv = 10)
print('training_accuracy', training_accuracy)
print()
print('Mean training_accuracy', training_accuracy.mean())
print('**'*8)

print(' testing_accuracy', testing_accuracy)
print()
print('Mean testing_accuracy', testing_accuracy.mean())
training_accuracy [0.78220859 0.78067485 0.76840491 0.81441718 0.74079755 0.7898773
 0.80828221 0.80521472 0.7898773  0.78955453]

Mean training_accuracy 0.7869309132717011
****************
 testing_accuracy [0.76146789 0.7706422  0.77981651 0.80275229 0.81105991 0.78341014
 0.79262673 0.82488479 0.79723502 0.76497696]

Mean testing_accuracy 0.7888872447469666
# AUC, ROC
from sklearn.metrics import roc_auc_score
logit_roc_auc_score = roc_auc_score(y_test, y_pred_test)
print(logit_roc_auc_score)
0.7928345626975764
from sklearn.metrics import roc_curve
fpr, tpr, thresholds = roc_curve(y_test, y_pred_test)

plt.figure(figsize=(15,15))
plt.plot(fpr, tpr, label="ROC Curve (area=%0.2f)" %logit_roc_auc_score)
plt.plot([0,1], [0,1], 'k--')
plt.xlim([0.0,1.0])
plt.ylim([0.0,1.0])
plt.xlabel("False Positive Rate")
plt.ylabel("True Positive Rate")
plt.title("Receiver Operating Characteristic with Area Under Curve")
plt.legend(loc='lower right')
plt.show()

# to put the result into the test data where we don't have transpoted column
df_test.head()
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Cabin_num	Destination_55 Cancri e	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	1	27.0	0	0.0	0.0	0.0	0.0	0.0	3	0	...	0	0	0	0	0	0	0	1	0	0
1	0	19.0	0	0.0	9.0	0.0	2823.0	0.0	4	0	...	0	0	0	0	0	0	1	0	0	0
2	1	31.0	0	0.0	0.0	0.0	0.0	0.0	0	1	...	0	0	0	1	0	0	0	0	1	0
3	0	38.0	0	0.0	6652.0	0.0	181.0	585.0	1	0	...	0	0	0	1	0	0	0	0	1	0
4	0	20.0	0	10.0	0.0	635.0	0.0	0.0	5	0	...	0	0	0	0	0	0	1	0	0	0
5 rows × 21 columns

final_result = Log_Regre.predict(df_test)
final_result = pd.DataFrame(final_result)
final_result
0
0	1.0
1	0.0
2	1.0
3	1.0
4	1.0
...	...
4272	1.0
4273	1.0
4274	1.0
4275	1.0
4276	1.0
4277 rows × 1 columns

final_result_1 = pd.concat([df_test, pd.DataFrame(final_result)], axis=1)
final_result_1
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Cabin_num	Destination_55 Cancri e	...	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars	0
0	1	27.000000	0	0.0	0.0	0.0	0.0	0.0	3	0	...	0	0	0	0	0	0	1	0	0	1.0
1	0	19.000000	0	0.0	9.0	0.0	2823.0	0.0	4	0	...	0	0	0	0	0	1	0	0	0	0.0
2	1	31.000000	0	0.0	0.0	0.0	0.0	0.0	0	1	...	0	0	1	0	0	0	0	1	0	1.0
3	0	38.000000	0	0.0	6652.0	0.0	181.0	585.0	1	0	...	0	0	1	0	0	0	0	1	0	1.0
4	0	20.000000	0	10.0	0.0	635.0	0.0	0.0	5	0	...	0	0	0	0	0	1	0	0	0	1.0
...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...
4272	1	34.000000	0	0.0	0.0	0.0	0.0	0.0	1496	0	...	0	0	0	0	0	0	1	0	0	1.0
4273	0	42.000000	0	0.0	847.0	17.0	10.0	144.0	431	0	...	0	0	0	0	0	0	0	0	0	1.0
4274	1	28.771969	0	0.0	0.0	0.0	0.0	0.0	296	1	...	0	0	0	1	0	0	0	0	1	1.0
4275	0	28.771969	0	0.0	2680.0	0.0	0.0	523.0	297	0	...	0	0	0	1	0	0	0	1	0	1.0
4276	1	43.000000	0	0.0	0.0	0.0	0.0	0.0	1498	0	...	0	0	0	0	0	0	1	0	0	1.0
4277 rows × 22 columns

final_result_1 = final_result_1.rename(columns = {0 : "Transported"})
final_result_1
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Cabin_num	Destination_55 Cancri e	...	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars	Transported
0	1	27.000000	0	0.0	0.0	0.0	0.0	0.0	3	0	...	0	0	0	0	0	0	1	0	0	1.0
1	0	19.000000	0	0.0	9.0	0.0	2823.0	0.0	4	0	...	0	0	0	0	0	1	0	0	0	0.0
2	1	31.000000	0	0.0	0.0	0.0	0.0	0.0	0	1	...	0	0	1	0	0	0	0	1	0	1.0
3	0	38.000000	0	0.0	6652.0	0.0	181.0	585.0	1	0	...	0	0	1	0	0	0	0	1	0	1.0
4	0	20.000000	0	10.0	0.0	635.0	0.0	0.0	5	0	...	0	0	0	0	0	1	0	0	0	1.0
...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...
4272	1	34.000000	0	0.0	0.0	0.0	0.0	0.0	1496	0	...	0	0	0	0	0	0	1	0	0	1.0
4273	0	42.000000	0	0.0	847.0	17.0	10.0	144.0	431	0	...	0	0	0	0	0	0	0	0	0	1.0
4274	1	28.771969	0	0.0	0.0	0.0	0.0	0.0	296	1	...	0	0	0	1	0	0	0	0	1	1.0
4275	0	28.771969	0	0.0	2680.0	0.0	0.0	523.0	297	0	...	0	0	0	1	0	0	0	1	0	1.0
4276	1	43.000000	0	0.0	0.0	0.0	0.0	0.0	1498	0	...	0	0	0	0	0	0	1	0	0	1.0
4277 rows × 22 columns

df_train
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_num	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	0	39.0	0	0.0	0.0	0.0	0.0	0.0	0.0	0	...	1	0	1	0	0	0	0	0	1	0
1	0	24.0	0	109.0	9.0	25.0	549.0	44.0	1.0	0	...	0	0	0	0	0	0	1	0	0	0
2	0	58.0	1	43.0	3576.0	0.0	6715.0	49.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
3	0	33.0	0	0.0	1283.0	371.0	3329.0	193.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
4	0	16.0	0	303.0	70.0	151.0	565.0	2.0	1.0	1	...	0	0	0	0	0	0	1	0	0	0
...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...
8688	0	41.0	1	0.0	6819.0	0.0	1643.0	74.0	0.0	98	...	1	1	0	0	0	0	0	0	1	0
8689	1	18.0	0	0.0	0.0	0.0	0.0	0.0	0.0	1499	...	0	0	0	0	0	0	0	1	0	0
8690	0	26.0	0	0.0	0.0	1872.0	1.0	0.0	1.0	1500	...	0	0	0	0	0	0	0	1	0	0
8691	0	32.0	0	0.0	1049.0	0.0	353.0	3235.0	0.0	608	...	0	0	0	0	0	1	0	0	1	0
8692	0	44.0	0	126.0	4688.0	0.0	0.0	12.0	1.0	608	...	0	0	0	0	0	1	0	0	1	0
8693 rows × 22 columns

titanic_test_submission = pd.concat([df_train, final_result_1])
titanic_test_submission
CryoSleep	Age	VIP	RoomService	FoodCourt	ShoppingMall	Spa	VRDeck	Transported	Cabin_num	...	Cabin_side_P	Cabin_deck_A	Cabin_deck_B	Cabin_deck_C	Cabin_deck_D	Cabin_deck_E	Cabin_deck_F	Cabin_deck_G	HomePlanet_Europa	HomePlanet_Mars
0	0	39.000000	0	0.0	0.0	0.0	0.0	0.0	0.0	0	...	1	0	1	0	0	0	0	0	1	0
1	0	24.000000	0	109.0	9.0	25.0	549.0	44.0	1.0	0	...	0	0	0	0	0	0	1	0	0	0
2	0	58.000000	1	43.0	3576.0	0.0	6715.0	49.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
3	0	33.000000	0	0.0	1283.0	371.0	3329.0	193.0	0.0	0	...	0	1	0	0	0	0	0	0	1	0
4	0	16.000000	0	303.0	70.0	151.0	565.0	2.0	1.0	1	...	0	0	0	0	0	0	1	0	0	0
...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...
4272	1	34.000000	0	0.0	0.0	0.0	0.0	0.0	1.0	1496	...	0	0	0	0	0	0	0	1	0	0
4273	0	42.000000	0	0.0	847.0	17.0	10.0	144.0	1.0	431	...	0	0	0	0	0	0	0	0	0	0
4274	1	28.771969	0	0.0	0.0	0.0	0.0	0.0	1.0	296	...	1	0	0	0	1	0	0	0	0	1
4275	0	28.771969	0	0.0	2680.0	0.0	0.0	523.0	1.0	297	...	1	0	0	0	1	0	0	0	1	0
4276	1	43.000000	0	0.0	0.0	0.0	0.0	0.0	1.0	1498	...	0	0	0	0	0	0	0	1	0	0
12970 rows × 22 columns

titanic_test_submission.to_csv('Spaceship_Titanic_Final.csv')
 
